"use strict";(self["webpackChunkweek03"]=self["webpackChunkweek03"]||[]).push([[788],{4881:function(t,e,a){function s(t){let e=t.toString().split("");return e.length<4?`$${t}`:e.length>=4?(e.splice(-3,0,","),`$${e.join("")}`):void 0}function r(t){const e=new Date(1e3*t);return`${e.getFullYear()}/${e.getMonth()+1}/${e.getDate()} ${e.getHours()}:${e.getMinutes()}:${e.getSeconds()}`}a.d(e,{A:function(){return s},N:function(){return r}})},8450:function(t,e,a){a(7658);var s=a(2578),r=a(6294),l=a(4677);e["Z"]=(0,s.Q_)("orderStore",{state:()=>({submitData:{user:{name:"",email:"",tel:"",address:""},message:""},tempOrders:[],tempData:{},pagination:{},api:{url:"https://vue3-course-api.hexschool.io/v2",path:"vue2022ron"}}),getters:{},actions:{getOrders(){this.axios.get(`${this.api.url}/api/${this.api.path}/admin/orders`).then((t=>{this.tempOrders=t.data.orders,this.pagination=t.data.pagination})).catch((t=>{const e=(0,r.Z)();e.swAlert("center","error",t.response.data.message,!1,!1)}))},checkStatus(){(async()=>{const t=document.cookie.replace(/(?:(?:^|.*;\s*)myToken\s*\=\s*([^;]*).*$)|^.*$/,"$1");this.axios.defaults.headers.common["Authorization"]=t;try{const t=await this.axios.post(`${this.api.url}/api/user/check`);this.checkResult=t.data.success,this.getProducts()}catch(e){const t=(0,r.Z)();await t.swAlert("center","error",e.response.data.message,!1,!1),this.router.push("/login")}})()},submit(){const t=(0,r.Z)(),e=(0,l.Z)();this.axios.post(`${this.api.url}/api/${this.api.path}/order`,{data:this.submitData}).then((a=>{e.getCart(),t.swAlert("center","success",`訂購的商品${a.data.message}`,!1,!1)})).catch((e=>{t.swAlert("center","error",e.response.data.message,!1,!1)}))},changePaid(){this.axios.put(`${this.api.url}/api/${this.api.path}/admin/order/${this.tempData.id}`,{data:this.tempData}).then((t=>{console.log(t)})).catch((t=>{console.log(t)}))},async put(){const t=(0,r.Z)();try{const e=await this.axios.put(`${this.api.url}/api/${this.api.path}/admin/product/${id}`,{data:putData});this.getProducts(this.selectEl.value),await t.swAlert("top-end","success",e.data.message,!1,!0)}catch(e){t.swAlert("top-end","error",e.response.data.message,!1,!0)}}}})},4677:function(t,e,a){var s=a(2578),r=a(6294);e["Z"]=(0,s.Q_)("cartStore",{state:()=>({api:{url:"https://vue3-course-api.hexschool.io/v2",path:"vue2022ron"},tempCart:{}}),getters:{},actions:{getCart(){this.axios.get(`${this.api.url}/api/${this.api.path}/cart`).then((t=>{this.tempCart=t.data.data})).catch((t=>{const e=(0,r.Z)();e.swAlert("center","error",t.response.data.message,!1,!1)}))},addCart(t,e=1){const a=(0,r.Z)();this.axios.post(`${this.api.url}/api/${this.api.path}/cart`,{data:{product_id:t,qty:e}}).then((t=>{this.getCart(),a.swAlert("top-end","success",`此商品${t.data.message}`,!1,!0)})).catch((t=>{a.swAlert("center","error",t.response.data.message,!1,!1)}))},changeQty(t){const e=(0,r.Z)();this.axios.put(`${this.api.url}/api/${this.api.path}/cart/${t.id}`,{data:{product_id:t.id,qty:t.qty}}).then((t=>{this.getCart(),e.swAlert("top-end","success",`${t.data.message}商品數量`,!1,!0)})).catch((t=>{e.swAlert("center","error",t.response.data.message,!1,!1)}))},delCartItem(t){const e=(0,r.Z)();this.axios.delete(`${this.api.url}/api/${this.api.path}/cart/${t}`).then((t=>{this.getCart(),e.swAlert("top-end","success",`此商品${t.data.message}`,!1,!0)})).catch((t=>{e.swAlert("center","error",t.response.data.message,!1,!1)}))},delCartItems(){const t=(0,r.Z)();this.axios.delete(`${this.api.url}/api/${this.api.path}/carts`).then((e=>{this.getCart(),t.swAlert("top-end","success",`購物車全部${e.data.message}`,!1,!0)})).catch((e=>{t.swAlert("center","error",e.response.data.message,!1,!1)}))}},debounce:{changeQty:500,addCart:500}})},7194:function(t,e,a){a.r(e),a.d(e,{default:function(){return _t}});var s=a(3396),r=a(7139);const l={class:"container"},o={class:"row"},d={class:"col-11 mx-auto"},i={class:"table table-hover mt-5"},n=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",{width:"150"},"下單時間"),(0,s._)("th",{width:"150"},"Email"),(0,s._)("th",{width:"200"},"購買內容"),(0,s._)("th",{width:"120"},"應付金額"),(0,s._)("th",{width:"120"},"付款狀態"),(0,s._)("th",{width:"120"},"訂單管理")])],-1),c={class:"text-start"},p={class:"text-start"},u={class:"text-start fs-6"},h={class:"text-center"},_={class:"btn-group"},m=["onClick"],w=(0,s._)("button",{type:"button",class:"btn btn-outline-danger btn-sm"},"刪除",-1);function g(t,e,a,g,b,D){const $=(0,s.up)("order-modal");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",l,[(0,s._)("div",o,[(0,s._)("div",d,[(0,s._)("table",i,[n,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(g.order.tempOrders,((t,e)=>((0,s.wg)(),(0,s.iD)("tr",{key:"item"+e},[(0,s._)("td",c,(0,r.zw)(g.convertDate(t.create_at)),1),(0,s._)("td",p,(0,r.zw)(t.user.email),1),(0,s._)("td",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.products,((t,e)=>((0,s.wg)(),(0,s.iD)("ul",{class:"list-unstyled",key:"list"+e},[(0,s._)("li",u,(0,r.zw)(t.product.title)+" / 數量："+(0,r.zw)(t.qty)+(0,r.zw)(t.product.unit),1)])))),128))]),(0,s._)("td",h,(0,r.zw)(g.thousandths(t.total)),1),(0,s._)("td",null,[(0,s._)("span",{class:(0,r.C_)({"text-success":t.is_paid,"text-danger":!t.is_paid,"fw-bold":!t.is_paid})},(0,r.zw)(""+(t.is_paid?"已付款":"未付款")),3)]),(0,s._)("td",null,[(0,s._)("div",_,[(0,s._)("button",{type:"button",class:"btn btn-outline-success btn-sm",onClick:e=>g.checkOrder(t)},"檢視",8,m),w])])])))),128))])])])])]),(0,s.Wm)($)],64)}var b=a(8450),D=a(4397),$=a(9242);const v={class:"modal fade",id:"orderModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},y={class:"modal-dialog modal-lg"},x={class:"modal-content"},f=(0,s._)("div",{class:"modal-header"},[(0,s._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,s._)("span",null,"訂單細節")]),(0,s._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),k={class:"modal-body"},z={key:0,class:"container"},C={class:"row"},A={class:"col-6"},Z=(0,s._)("h5",null,"用戶資料",-1),M={class:"table"},q=(0,s._)("th",{style:{width:"100px"}},"姓名",-1),O=(0,s._)("th",null,"E-mail",-1),H=(0,s._)("th",null,"電話",-1),S=(0,s._)("th",null,"地址",-1),Y={class:"col-6"},E=(0,s._)("h5",null,"訂單細節",-1),P={class:"table"},Q=(0,s._)("th",{style:{width:"100px"}},"訂單編號",-1),U=(0,s._)("th",null,"下單時間",-1),I=(0,s._)("th",null,"付款狀態",-1),K={key:0},N=(0,s._)("th",null,"付款時間",-1),j={class:"fw-bold"},L={class:"text-success"},B=(0,s._)("th",null,"總金額",-1),F=(0,s._)("h5",null,"選購商品",-1),R={class:"card-body"},T={class:"card-title"},V={class:"card-text"},W={class:"pe-3"},G={class:"pe-3"},J={class:"text-danger fw-bold"},X={class:"d-flex justify-content-end"},tt=(0,s._)("p",{class:"pe-3"},"變更付款狀態",-1),et={class:"form-check form-switch"},at=["for"],st=["id"],rt={class:"modal-footer"},lt=(0,s._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ot(t,e,a,l,o,d){return(0,s.wg)(),(0,s.iD)("div",v,[(0,s._)("div",y,[(0,s._)("div",x,[f,(0,s._)("div",k,[l.order.tempData.user?((0,s.wg)(),(0,s.iD)("div",z,[(0,s._)("div",C,[(0,s._)("div",A,[Z,(0,s._)("table",M,[(0,s._)("tbody",null,[(0,s._)("tr",null,[q,(0,s._)("td",null,(0,r.zw)(l.order.tempData.user.name),1)]),(0,s._)("tr",null,[O,(0,s._)("td",null,(0,r.zw)(l.order.tempData.user.email),1)]),(0,s._)("tr",null,[H,(0,s._)("td",null,(0,r.zw)(l.order.tempData.user.tel),1)]),(0,s._)("tr",null,[S,(0,s._)("td",null,(0,r.zw)(l.order.tempData.user.address),1)])])])]),(0,s._)("div",Y,[E,(0,s._)("table",P,[(0,s._)("tbody",null,[(0,s._)("tr",null,[Q,(0,s._)("td",null,(0,r.zw)(l.order.tempData.id),1)]),(0,s._)("tr",null,[U,(0,s._)("td",null,(0,r.zw)(l.convertDate(l.order.tempData.create_at)),1)]),(0,s._)("tr",null,[I,(0,s._)("td",{class:(0,r.C_)(["fw-bold",{"text-success":l.order.tempData.is_paid,"text-danger":!l.order.tempData.is_paid}])},(0,r.zw)(""+(l.order.tempData.is_paid?"已付款":"尚未付款")),3)]),l.order.tempData.paid_date?((0,s.wg)(),(0,s.iD)("tr",K,[N,(0,s._)("td",j,[(0,s._)("span",L,(0,r.zw)(l.convertDate(l.order.tempData.paid_date)),1)])])):(0,s.kq)("",!0),(0,s._)("tr",null,[B,(0,s._)("td",{class:(0,r.C_)([{"text-success":l.order.tempData.is_paid,"text-danger":!l.order.tempData.is_paid},"fw-bold"])},"$"+(0,r.zw)(l.thousandths(l.order.tempData.total)),3)])])]),F,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.order.tempData.products,((t,e)=>((0,s.wg)(),(0,s.iD)("div",{key:"product"+e,class:"card w-75 mb-3"},[(0,s._)("div",R,[(0,s._)("h5",T,(0,r.zw)(t.product.title),1),(0,s._)("p",V,[(0,s.Uk)(" 單價："),(0,s._)("span",W,"$"+(0,r.zw)(l.thousandths(t.product.price)),1),(0,s.Uk)(" 數量："),(0,s._)("span",G,(0,r.zw)(`${t.qty}${t.product.unit}`),1),(0,s.Uk)(" 總價："),(0,s._)("span",J,"$"+(0,r.zw)(l.thousandths(t.total)),1)])])])))),128)),(0,s._)("div",X,[tt,(0,s._)("div",et,[(0,s._)("label",{class:"form-check-label",for:l.order.tempData.id},[(0,s.wy)((0,s._)("input",{class:"form-check-input",type:"checkbox",id:l.order.tempData.id,"onUpdate:modelValue":e[0]||(e[0]=t=>l.order.tempData.is_paid=t)},null,8,st),[[$.e8,l.order.tempData.is_paid]]),(0,s._)("span",{class:(0,r.C_)(["fw-bold",{"text-success":l.order.tempData.is_paid}])},(0,r.zw)(""+(l.order.tempData.is_paid?"已付款":"未付款")),3)],8,at)])])])])])):(0,s.kq)("",!0)]),(0,s._)("div",rt,[lt,(0,s._)("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:e[1]||(e[1]=t=>l.order.changePaid())}," 變更付款狀態 ")])])])])}var dt=a(4881),it={setup(){const t=(0,b.Z)();return{order:t,thousandths:dt.A,convertDate:dt.N}}},nt=a(89);const ct=(0,nt.Z)(it,[["render",ot]]);var pt=ct,ut={components:{orderModal:pt},props:["store"],setup(t){const{status:e}=t.store,a=(0,b.Z)(),r=()=>{const t=new D.Z(document.getElementById("orderModal"));t.show()},l=t=>{r(),a.tempData=t};return(0,s.bv)((()=>{a.getOrders()})),{order:a,thousandths:dt.A,convertDate:dt.N,openModal:r,checkOrder:l}}};const ht=(0,nt.Z)(ut,[["render",g]]);var _t=ht}}]);
//# sourceMappingURL=788.15dbeddd.js.map